{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1e35834cc5869ccb24ae","webpack:///./src/index.js"],"names":["WechatSound","doc","Audio","prototype","_play","play","HTMLAudioElement","HTMLVideoElement","wxPlayAudio","audio","WeixinJSBridge","invoke","e","self","evtFns","ex","push","evt","i","length","document","removeEventListener","addEventListener","preloads","preloadVideo","url","playtime","videoObj","createElement","setAttribute","oncanplay","setTimeout","pause","preloadAudio","module","exports","window"],"mappings":"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","file":"wechat-sound.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1e35834cc5869ccb24ae","/**\n * Created by johnny on 2017/12/25.\n */\nfunction WechatSound(doc) {\n    // 原理：调用链中的某个事件被标识为用户事件而非系统事件\n    // 进而导致浏览器以为是用户触发播放而允许播放\n\n    Audio.prototype._play = Audio.prototype.play;\n    HTMLAudioElement.prototype._play = HTMLAudioElement.prototype.play;\n    //Video.prototype._play = Video.prototype.play;\n    HTMLVideoElement.prototype._play=HTMLVideoElement.prototype.play;\n    function wxPlayAudio(audio) {\n        /// <summary>\n        /// 微信播放Hack\n        /// </summary>\n        /// <param name=\"audio\" type=\"Audio\">音频对象</param>\n        WeixinJSBridge.invoke('getNetworkType', {}, function (e) {\n            audio._play();\n        });\n    }\n\n    function play() {\n        var self = this;\n        self._play();\n        var evtFns = [];\n        try {\n            wxPlayAudio(self);\n        } catch (ex) {\n            evtFns.push(\"WeixinJSBridgeReady\", function evt() {\n                wxPlayAudio(self);\n                for (var i = 0; i < evtFns.length; i += 2) document.removeEventListener(evtFns[i], evtFns[i + 1], false);\n            });\n            document.addEventListener(\"WeixinJSBridgeReady\", evtFns[evtFns.length - 1], false);\n        }\n    }\n    Audio.prototype.play = play;\n    HTMLAudioElement.prototype.play = play;\n    HTMLVideoElement.prototype.play=play;\n    return this;\n}\nWechatSound.prototype.preloads={}\nWechatSound.prototype.preloadVideo=function(url,playtime){\n    playtime=playtime||100;\n    let videoObj=document.createElement('video')\n    videoObj.setAttribute('webkit-playsinline', true);\n    videoObj.setAttribute('playsinline', true);\n    videoObj.setAttribute('preload', 'load');\n    videoObj.setAttribute('src', url);\n    this.preloads[url]=videoObj;\n    videoObj.oncanplay = function () {\n        setTimeout(function () {\n          //     console.log('canplay:'+url);\n            videoObj.pause();\n        },playtime)\n\n    }\n    videoObj.play();\n};\nWechatSound.prototype.preloadAudio=function(url,playtime){\n    playtime=playtime||100;\n    let videoObj=new Audio()\n    videoObj.setAttribute('preload', 'load');\n    videoObj.setAttribute('src', url);\n    this.preloads[url]=videoObj;\n    videoObj.oncanplay = function () {\n        setTimeout(function () {\n            videoObj.pause();\n        },playtime)\n\n    }\n    videoObj.play();\n};\n\nmodule.exports=WechatSound;\n window.WechatSound=WechatSound;\n//WechatSound(document);\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}